---

# Set to false to completely disable the role
beats_enabled: true

beats_flavor: auditbeat
# Set this variable to the name of the beat that you want the role to install
# and configure.

beats_unset_facts: false
# Set this to true to set to None some variables that this role uses. Set it to
# true if you want to use this role multiple times during an ansible run.
# Such variables are set to defaults by the role, not through this defaults.yml
# file but by using `set_fact` tasks. This is done to provide default based on
# the OS you are using. This single defaults.yml file could have only been used
# to provide defaults for a single OS. Since these variables are assigned
# a value with `set_fact`, they will keep their value throughout an ansible run,
# ie they will be exposed to the playbook. If you include this role more than
# once, eg in a loop, in order to install more than one beat (eg both auditbeat
# and packetbeat), the `set_fact` tasks this role uses will be skipped since the
# variables already have a value. This means that the second beat will be
# installed with the settings of the first, which is wrong. Setting
# `beats_unset_facts` to true, will unset such sensitive variables so that the
# second beat can be configured properly.
# Installation {{{
# The version of beats to use, eg 6, 7, etc. This is only used when
# `beats_use_upstream_repo` is set to `true`
beats_major_version: 7

# Whether the beats service should be enabled at the end of the role.
beats_enable_service: true
# }}}
# Certificates {{{
beats_certificates: ~
# Certificates that the beats output should use to authenticate with the remote
# output.  Use this variable to point to certificate files on the ansible
# controller that should be uploaded to the beats server. This variable will
# also be used to constuct the relevant section in the output configuration of
# beats.  The format of this variable is as follows: beats_certificates:
#   ca: path/to/ca.cert
#   cert: path/to/node/cert
#   key: path/to/node/key

beats_certificates_dir: ~
# The folder where `beats_certificates` will be uploaded into. If you leave this
# empty, the folder depends on the OS you are using and is defined in the
# `vars/paths/YOUR_OS_FAMILY_HERE.yml` file that comes with this role (via the
# `_beats_certificates_dir` file).

beats_certificates_password: ''
# The password used to protect the generated private keys. Leave empty if the
# certificates are not password protected. The password will be available as
# `${OUTPUT_CERT_KEY_PASSPHRASE}` to use in `beats_config`. An empty password
# equals an unset password. Do not set this variable to None/~ as in this case,
# it will not be added to the keystore. This will lead to the variable
# `${OUTPUT_CERT_KEY_PASSPHRASE}` to be undefined in `beats_config`.

beats_keystore_update: false
# Set to true if you need to update the passwords and certificate passphrases
# that are stored in the keystore. Set this to true if you changed any password
# or passphrase.  This is false by default to support idempotency.
# }}}
# Configuration {{{
beats_systemd_override: ~
# Use this variable to override variables in the default systemd service file
# for beats. Eg:
# beats_systemd_override: |
#   [Service]
#   Environment="BEAT_LOG_OPTS=-e -d elasticsearch"

beats_check_output: false
# Check if beats can connect successfully to the configured output before
# starting beats.

beats_output_user: ~
beats_output_pass: ~
# Set these variables to the credentials that beats should use to login to
# the output that you have configured in `beats_config`. These are used by
# the role to store the output user/pass in the secure keystore. They are not
# used for any other task. When configuring your output in `beats_config`,
# you can reference these variables using `${OUTPUT_USER}` and `${OUTPUT_PASS}`.

beats_config: {}
# The beats configuration. This will be combined with a default
# configuration that comes with this role. The variables below are used by the
# default configuration and are meant as a convenience. You can ignore them and
# set the relevant settings in `beats_config` directly.

beats_name: "{{ inventory_hostname }}"
# The name of the beat.

# CURRENTLY UNSUPPORTED, DO NOT USE
beats_path_home: ~
beats_path_config: ~
beats_path_data: ~
beats_path_logs: ~
# Use this variables to override the default paths that come with this role for
# your OS (which are set based on the official Beats documentation).
# These are currently not supported. To support them, the role will need:
# - in the case of linux, have additional tasks to create systemd overrides that
# use the paths the user has defined
# - in the case of windows, find a way to override the paths that the service is
# passing to the beats executable.
# }}}
# Other {{{
beats_extract_index_template: false
# Whether to extract the default index template that comes with beats. This
# template is automatically loaded to elasticsearch if the elasticsearch output
# is configured in the beats configuration. If, however, beats does not
# communicate directly with elasticseach (eg only a `logstash` output has been
# configured), then the template needs to be manually loaded. Use this variable
# to extract the index template and download it to the ansible controller so
# that it can be loaded into elasticsearch manually (or via an `elasticsearch`
# ansible role, such `nkakouros.elasticsearch`). The extracted index template
# will be named `beats.7.1.1.template.json`, where `7.1.1` will be the
# actual installed version of beats.

beats_index_template_download_dir: ''
# Where on the ansible controller the index template should be downloaded to.

beats_install_kibana_dashboards: false
# Set to true to load the kibana dashboards that come with beats. If you set
# this variable to true, the variables below will be used. Otherwise, they are
# ignored.

beats_kibana_host: ~
# Address where the Kibana endpoint can be reached at.
beats_kibana_path: ~
# HTTP path prefix to prepend to http api calls

beats_kibana_username: ~
beats_kibana_password: ~
# The user credentials that beats should use to log into the Kibana
# endpoint. Leave `None` if no user login is needed.

beats_kibana_ssl_enabled: true
# Whether to enable ssl when connecting to the Kibana endpoint.
beats_kibana_ssl_ca: ~
beats_kibana_ssl_crt: ~
beats_kibana_ssl_key: ~
beats_kibana_ssl_key_passphrase: ~
# The role will by default add to `beats_config` a kibana endpoint
# configuration based on you settings above.  The certificate files will be
# uploaded to the beats server at the `{{ beats_certificates_dir }}
# /kibana` directory. The username, password and key_passphrase will be added to
# the secure keystore and you can refer to them in you `beats_config` with
# `${KIBANA_USER}`, `${KIBANA_PASS}` and `${KIBANA_CERT_KEY_PASSPHRASE}`
# respectively.
# # }}}
# Auditbeat specifics {{{
beats_enabled_bundled_rules: []
# A list of rule files that are bundled with this role and that the role should
# indeed upload to beats. The list should contain the filenames of the rule
# files you want to use. For instance, if you find the
# `files/00-default-rules.conf` rules useful, set:
# ```yml
# beats_enabled_bundled_roles:
#   - 00-default-rules.conf
# ```
# These files will be uploaded to `beats_rules_dir`.

beats_rules_dir: /etc/beats/audit.rules.d
# The directory where audit rule files are located. These setting is also used
# by the role to know where it should upload the files in
# `beats_enabled_bundled_rules`. This directory will be searched for
# `*.conf` files.

beats_mask_journald_audit: true
# Set this to true to prevent journald from listening for audit messages. This
# should save on CPU and disk space.
# }}}
# Filebeat specifics {{{
beat_filebeat_modules: []
# The list of default configurations for filebeat modules to enable. These
# configurations come shipped with filebeat.
# }}}
# Heartbeat specifics {{{
beats_heartbeat_monitors_path: /etc/heartbeat/monitors.d/
# A directory where dynamically loaded monitor config files are located.

beats_heartbeat_monitor_files: []
# A list of monitor conf files that should be uploaded to
# `beats_heartbeat_monitor_files`.
# }}}
